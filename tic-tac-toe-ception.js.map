{"version":3,"file":"tic-tac-toe-ception.js","sources":["../src/tictactoeWinning.js","../src/Vector2D.js","../src/fireworks.js","../src/Cell.js","../src/Grid.js","../src/Player.js","../src/Game.js","../src/index.js"],"sourcesContent":["function isHorizontalWin(cells, cellId, player) {\n  const startId = ((cellId / 3) | 0) * 3;\n  const ids = [];\n  for (let i = 0; i < 3; i++) {\n    if (!cells[startId + i].isOwnedBy(player)) return false;\n    ids.push(startId + i);\n  }\n  return ids;\n}\n\nfunction isVerticalWin(cells, cellId, player) {\n  const startId = cellId % 3;\n  const ids = [];\n  for (let i = 0; i < 3; i++) {\n    if (!cells[startId + i * 3].isOwnedBy(player)) return false;\n    ids.push(startId + i * 3);\n  }\n  return ids;\n}\n\nfunction isDiagonalWin(cells, cellId, player) {\n  if (cellId % 1) return false; // if cellId not on diagonal\n  return isDiagonalWin1(...arguments) || isDiagonalWin2(...arguments);\n}\nfunction isDiagonalWin1(cells, cellId, player) {\n  if (cellId % 4 === 2) return false;\n  const ids = [];\n  for (let i = 0; i < 3; i++) {\n    if (!cells[i * 4].isOwnedBy(player)) return false;\n    ids.push(i * 4);\n  }\n  return ids;\n}\nfunction isDiagonalWin2(cells, cellId, player) {\n  if (cellId % 8 === 0) return false;\n  const ids = [];\n  for (let i = 1; i < 4; i++) {\n    if (!cells[i * 2].isOwnedBy(player)) return false;\n    ids.push(i * 2);\n  }\n  return ids;\n}\n\nexport default function makeAMove(cells, cellId, player) {\n  return (\n    isVerticalWin(...arguments) ||\n    isHorizontalWin(...arguments) ||\n    isDiagonalWin(...arguments)\n  );\n}\n","/*\n\nSimple 2D JavaScript Vector Class\n\nHacked from evanw's lightgl.js\nhttps://github.com/evanw/lightgl.js/blob/master/src/vector.js\n\n*/\n\nfunction Vector(x, y) {\n  this.x = x || 0;\n  this.y = y || 0;\n}\n\n/* INSTANCE METHODS */\n\nVector.prototype = {\n  add(...vectors) {\n    for (const v of vectors) {\n      this.x += v.x;\n      this.y += v.y;\n    }\n  },\n\n  multiply(v) {\n    if (typeof v !== \"number\") {\n      this.x *= v.x;\n      this.y *= v.y;\n    } else {\n      this.x *= v;\n      this.y *= v;\n    }\n    return this;\n  },\n  divide(v) {\n    if (typeof v !== \"number\") {\n      if (v.x != 0) this.x /= v.x;\n      if (v.y != 0) this.y /= v.y;\n    } else {\n      if (v != 0) {\n        this.x /= v;\n        this.y /= v;\n      }\n    }\n    return this;\n  },\n  equals(v) {\n    return this.x == v.x && this.y == v.y;\n  },\n  dot(v) {\n    return this.x * v.x + this.y * v.y;\n  },\n  cross(v) {\n    return this.x * v.y - this.y * v.x;\n  },\n  get length() {\n    return Math.sqrt(this.dot(this));\n  },\n  normalize() {\n    return this.divide(this.length);\n  },\n\n  clone() {\n    return new Vector(this.x, this.y);\n  },\n};\n\n/* STATIC */\nVector.NUL = Object.freeze({\n  x: 0,\n  y: 0,\n  clone() {\n    return new Vector();\n  },\n});\n\nexport default Vector;\n","import Vector from \"./Vector2D.js\";\n\nconst colors = [\n  \"#b3312c\",\n  \"#eb8844\",\n  \"#decf2a\",\n  \"#41cd34\",\n  \"#3b511a\",\n  \"#6689d3\",\n  \"#287697\",\n  \"#253192\",\n  \"#7b2fbe\",\n  \"#c354cd\",\n  \"#d88198\",\n  \"#f0f0f0\",\n  \"#ababab\",\n  \"#434343\",\n  \"#1e1b1b\",\n  \"#51301a\",\n];\n\nconst GRAVITY = new Vector(0, -0.981);\nfunction* trackObjectPosition(properties) {\n  const acceleration = properties.initialAcceleration.clone();\n  const velocity = properties.initialVelocity.clone();\n  const position = properties.initialPosition.clone();\n  yield position;\n  for (let i = 0; i < properties.lifeExpectancy; i++) {\n    const thrust =\n      i < properties.fuelAutonomy\n        ? velocity\n            .clone()\n            .normalize()\n            .multiply(properties.motorThrust * (1 - Math.exp(-i)))\n        : Vector.NUL;\n    const friction = velocity.clone().multiply(-properties.frictionCoefficient);\n    acceleration.add(GRAVITY, thrust, friction);\n    velocity.add(acceleration);\n    position.add(velocity);\n    yield position;\n  }\n  return { position, velocity, acceleration };\n}\n\nasync function drawTrajectory(ctx, ballisticObject) {\n  return new Promise((resolve) => {\n    const getPosition = trackObjectPosition(ballisticObject);\n\n    let previousTimestamp;\n    function nextFrame(timestamp) {\n      for (let i = previousTimestamp || timestamp; i < timestamp; i++) {\n        const { value: position, done } = getPosition.next();\n        if (done) return resolve(position);\n        ctx.fillStyle = ballisticObject.color;\n        ctx.beginPath();\n        ctx.rect(\n          position.x >> 20,\n          position.y >> 20,\n          ballisticObject.thickness,\n          1\n        );\n        ctx.fill();\n      }\n      requestAnimationFrame(nextFrame);\n      previousTimestamp = timestamp;\n    }\n    requestAnimationFrame(nextFrame);\n  });\n}\n\nfunction spiderEffect({ position: initialPosition, velocity }, color) {\n  return {\n    initialPosition,\n    initialVelocity: new Vector(0, velocity.y),\n    initialAcceleration: new Vector(\n      (Math.random() - 0.5) * 2000,\n      -GRAVITY.y * 1000\n    ),\n    lifeExpectancy: 800,\n    fuelAutonomy: 0,\n    motorThrust: 0,\n    frictionCoefficient: Math.random() * 0.000015 + 0.000005,\n    thickness: 3,\n    color,\n  };\n}\n\nexport function launchRocket(\n  ctx,\n  initialPosition = Vector.NUL,\n  color = undefined\n) {\n  const skyRocket = {\n    initialPosition,\n    initialVelocity: Vector.NUL,\n    initialAcceleration: new Vector(\n      ((Math.random() + 1.5) % 2) - 1, // [-1, -.5]U[.5, 1]\n      GRAVITY.y * -7\n    ),\n    lifeExpectancy: 900 + Math.random() * 300,\n    fuelAutonomy: 600,\n    motorThrust: GRAVITY.y * -5,\n    frictionCoefficient: Math.random() * 0.000015 + 0.000005,\n    thickness: 7,\n    color: color || colors[(Math.random() * colors.length) | 0],\n  };\n\n  return drawTrajectory(ctx, skyRocket)\n    .then((previousState) =>\n      Promise.all(\n        Array.from({ length: Math.random() * 10 }, () =>\n          drawTrajectory(ctx, spiderEffect(previousState, skyRocket.color))\n        )\n      )\n    )\n    .catch(console.error);\n}\n\n/**\n * @param {HTMLCanvasElement} canvas\n * @param {Promise<>} promiseToWaitFor Promise that resolves when it's time to\n *                                     fade out the canvas (usually a\n *                                     `Promise.all` to wait for all\n *                                     `launchRocket` animations to complete.\n * @param {CanvasRenderingContext2D} ctx\n * @returns {FrameRequestCallback} Frame by frame callback that erases previous\n *                                 traces.\n */\nexport function fadeOutChemTrails(canvas, promiseToWaitFor, ctx = null) {\n  const { width, height } = canvas;\n\n  if (ctx == null) {\n    ctx = canvas.getContext(\"2d\");\n  }\n\n  let previousTimestamp, animationFrameID;\n  function nextFrame(timestamp) {\n    const frame = ctx.getImageData(0, 0, width, height);\n    const speed = (timestamp - previousTimestamp) / 16;\n    for (let i = 3; i < frame.data.length; i += 4) {\n      const val = frame.data[i];\n      if (val > 16) {\n        frame.data[i] = val - (val >> 3) * speed;\n      }\n    }\n    ctx.putImageData(frame, 0, 0);\n\n    animationFrameID = requestAnimationFrame(nextFrame);\n    previousTimestamp = timestamp;\n  }\n\n  promiseToWaitFor.then(() => {\n    canvas.addEventListener(\"transitionend\", () => {\n      cancelAnimationFrame(animationFrameID);\n      canvas.remove();\n    });\n    canvas.style.transformOrigin = \"top\";\n    canvas.style.transition = \"all 3s ease-in\";\n    canvas.style.transitionProperty = \"opacity,transform\";\n    canvas.style.opacity = 0;\n    canvas.style.transform = \"scaleY(1.5)\";\n  });\n\n  return nextFrame;\n}\n\nconst delay = (delay) => new Promise((done) => setTimeout(done, delay));\n\n/**\n * @param {number} numberOfRockets\n * @param {number} delayBetweenRockets in milliseconds\n * @param {number} scale Canvas default size is 1000x1000 px²\n * @returns {HTMLCanvasElement}\n */\nexport default function autoShow(\n  numberOfRockets = 5,\n  delayBetweenRockets = 200,\n  scale = 1\n) {\n  const WIDTH = 1000 * scale;\n  const HEIGHT = 1000 * scale;\n  const canvas = document.createElement(\"canvas\");\n  canvas.height = HEIGHT;\n  canvas.width = WIDTH;\n  const ctx = canvas.getContext(\"2d\");\n  ctx.setTransform(scale, 0, 0, -scale, WIDTH / 2, HEIGHT);\n  requestAnimationFrame(\n    fadeOutChemTrails(\n      canvas,\n      Promise.all(\n        Array.from({ length: numberOfRockets }, (_, i) =>\n          delay(Math.random() * 50 + i * delayBetweenRockets).then(() =>\n            launchRocket(ctx)\n          )\n        )\n      ),\n      ctx\n    )\n  );\n\n  return canvas;\n}\n","const cellInstances = new WeakMap();\n\nfunction onclick(event) {\n  cellInstances.get(event.target).makeMove();\n}\n\nexport default class Cell {\n  #id;\n  #owner;\n  #game;\n  #htmlElement = this.createHTMLElement();\n\n  constructor(id, game) {\n    this.#id = id;\n    this.#game = game;\n  }\n\n  createHTMLElement() {\n    const button = document.createElement(\"button\");\n    button.addEventListener(\"click\", onclick);\n    button.className = \"cell\";\n    button.setAttribute(\"aria-label\", \"Empty cell\");\n    cellInstances.set(button, this);\n    return button;\n  }\n\n  makeMove() {\n    this.#game.makeMove(this);\n  }\n\n  get htmlElement() {\n    return this.#htmlElement;\n  }\n\n  isOwnedBy(player) {\n    return this.#owner === player;\n  }\n\n  setFoot(player) {\n    this.#owner = player;\n    this.htmlElement.removeAttribute(\"aria-label\");\n    this.htmlElement.dataset.player = player.symbol;\n  }\n\n  setWinningFlag() {\n    this.htmlElement.classList.add(\"win\");\n  }\n\n  isEmpty() {\n    return !this.#owner;\n  }\n\n  get id() {\n    return this.#id;\n  }\n\n  enable() {\n    this.htmlElement.disabled = false;\n  }\n  disable() {\n    this.htmlElement.disabled = true;\n  }\n}\n","import Cell from \"./Cell.js\";\nimport getTicTacToeWinner from \"./tictactoeWinning.js\";\nimport launchFireworks from \"./fireworks.js\";\n\nconst SUPPORT_FOR_SCROLL_INTO_VIEW = Boolean(\n  Element.prototype.scrollIntoViewIfNeeded\n);\nexport default class Grid extends Cell {\n  #cells;\n\n  constructor(id, game) {\n    super(id);\n    this.#cells = Array.from({ length: 9 }, (_, i) => new Cell(i, game));\n    this.htmlElement.append(...this.#cells.map((cell) => cell.htmlElement));\n  }\n\n  createHTMLElement() {\n    const div = document.createElement(\"div\");\n    div.className = \"tic-tac-toe\";\n    return div;\n  }\n\n  has(cell) {\n    return this.#cells.includes(cell);\n  }\n\n  isLegal(cell) {\n    return (\n      this.has(cell) &&\n      (cell.isEmpty() || this.#cells.every((cell) => !cell.isEmpty()))\n    );\n  }\n\n  makeMove(player, cell) {\n    if (!this.isLegal(cell)) {\n      throw new Error(\"Illegal move\");\n    }\n    if (cell.isEmpty()) {\n      cell.setFoot(player);\n      this.checkForWinner(player, cell);\n    }\n  }\n\n  checkForWinner(player, cell) {\n    if (!this.isEmpty()) return;\n    const winningCells = getTicTacToeWinner(this.#cells, cell.id, player);\n    if (winningCells) {\n      const boundingRect = this.htmlElement.getBoundingClientRect();\n      const canvas = launchFireworks(9, 200, boundingRect.height / 1000);\n      for (const cellId of winningCells) {\n        this.#cells[cellId].setWinningFlag();\n      }\n      this.setFoot(player);\n      canvas.style.top = boundingRect.top - boundingRect.height / 6 + \"px\";\n      canvas.style.left = boundingRect.left + \"px\";\n      document.body.append(canvas);\n    }\n  }\n\n  /**\n   * Enables empty cells\n   * When there are no empty cells, all cells are enabled.\n   */\n  enable() {\n    const lonelyCells = this.#cells.filter((cell) => cell.isEmpty());\n    (lonelyCells.length ? lonelyCells : this.#cells).forEach((cell) =>\n      cell.enable()\n    );\n    if (SUPPORT_FOR_SCROLL_INTO_VIEW) {\n      this.htmlElement.scrollIntoViewIfNeeded(true);\n    }\n  }\n  disable() {\n    this.#cells.forEach((cell) => cell.disable());\n  }\n}\n","export default class Player {\n  #symbol;\n\n  constructor(symbol) {\n    this.#symbol = symbol;\n  }\n\n  get symbol() {\n    return this.#symbol;\n  }\n}\n","import getTicTacToeWinner from \"./tictactoeWinning.js\";\nimport launchFireworks from \"./fireworks.js\";\nimport Grid from \"./Grid.js\";\nimport Player from \"./Player.js\";\n\nexport default class Game {\n  #grids = Array.from({ length: 9 }, (_, i) => new Grid(i, this));\n  #currentGrid;\n  #players = [new Player(\"❌\"), new Player(\"⭕\")];\n  #currentPlayer = this.#players[0];\n\n  makeMove(cell) {\n    if (!this.#currentGrid) {\n      this.#currentGrid = this.#grids.find((grid) => grid.has(cell));\n      this.#grids.forEach((grid) => grid.disable());\n    } else {\n      this.#currentGrid.disable();\n    }\n    this.#currentGrid.makeMove(this.#currentPlayer, cell);\n    if (!this.checkForWinner()) {\n      this.#currentPlayer = this.#players[\n        (this.#players.indexOf(this.#currentPlayer) + 1) % this.#players.length\n      ];\n      this.#currentGrid = this.#grids[cell.id];\n      this.#currentGrid.enable();\n    }\n  }\n\n  checkForWinner() {\n    const winningGrids = getTicTacToeWinner(\n      this.#grids,\n      this.#currentGrid.id,\n      this.#currentPlayer\n    );\n    if (winningGrids) {\n      for (const gridId of winningGrids) {\n        const grid = this.#grids[gridId];\n        const boundingRect = grid.htmlElement.getBoundingClientRect();\n        const canvas = launchFireworks(9, 200, boundingRect.height / 1000);\n        canvas.style.top = boundingRect.top - boundingRect.height / 6 + \"px\";\n        canvas.style.left = boundingRect.left + \"px\";\n        document.body.append(canvas);\n        grid.setWinningFlag();\n      }\n\n      Game.showDialog(this.#currentPlayer).append(launchFireworks(20, 150));\n\n      return false;\n    }\n  }\n\n  get htmlElement() {\n    const frag = document.createDocumentFragment();\n    frag.append(...this.#grids.map((grid) => grid.htmlElement));\n    return frag;\n  }\n\n  static startNewGame() {\n    const newGame = new Game();\n    const main = document.querySelector(\"main\");\n    while (main.firstChild) main.removeChild(main.firstChild);\n    main.append(newGame.htmlElement);\n  }\n\n  static showDialog(player) {\n    if (!this.dialogElement) {\n      const celebrateWinnerBanner = document.createElement(\"dialog\");\n      const h2 = document.createElement(\"h2\");\n      celebrateWinnerBanner.winnerSymbol = document.createTextNode(\n        player.symbol\n      );\n      h2.append(celebrateWinnerBanner.winnerSymbol, \" wins!\");\n      const form = document.createElement(\"form\");\n      form.method = \"dialog\";\n      const button = document.createElement(\"input\");\n      button.type = \"submit\";\n      button.value = \"New Game\";\n      form.append(button);\n\n      form.addEventListener(\"submit\", Game.startNewGame);\n      celebrateWinnerBanner.append(h2, form);\n      document.body.append(celebrateWinnerBanner);\n      this.dialogElement = celebrateWinnerBanner;\n    } else {\n      this.dialogElement.winnerSymbol = player.symbol;\n    }\n    this.dialogElement.showModal();\n    return this.dialogElement;\n  }\n}\n","import Game from \"./Game.js\";\n\nGame.startNewGame();\n\nif (typeof PRODUCTION_ENV !== \"undefined\") {\n  if (\"serviceWorker\" in navigator) {\n    navigator.serviceWorker\n      .register(\"./sw.js\", { scope: \"./\" })\n      .then(() => {\n        const div = document.createElement(\"div\");\n        const remove = () => div.remove();\n        div.style.position = \"fixed\";\n        div.style.bottom = \"1rem\";\n        div.style.right = \"50vw\";\n        div.style.transform = \"translateX(50%)\";\n        div.style.backgroundColor = \"#888A\";\n        div.style.color = \"#fff\";\n        div.style.padding = \"1rem\";\n        div.style.borderRadius = \"3px\";\n        div.style.cursor = \"pointer\";\n        div.textContent = \"Ready to work offline\";\n        div.addEventListener(\"click\", remove);\n        setTimeout(remove, 2999);\n        document.body.append(div);\n      })\n      .catch((error) => {\n        // registration failed\n        console.warn(error);\n      });\n  }\n} else {\n  import(\"../scripts/autoRefresh.js\").catch(console.warn);\n}\n"],"names":["isHorizontalWin","cells","cellId","player","startId","ids","i","isOwnedBy","push","isVerticalWin","isDiagonalWin","isDiagonalWin1","arguments","isDiagonalWin2","makeAMove","Vector","x","y","this","prototype","add","v","multiply","divide","equals","dot","cross","length","Math","sqrt","normalize","clone","NUL","Object","freeze","drawTrajectory","ctx","ballisticObject","Promise","resolve","previousTimestamp","getPosition","trackObjectPosition","requestAnimationFrame","nextFrame","timestamp","next","position","value","done","fillStyle","color","beginPath","rect","thickness","fill","colors","GRAVITY","properties","acceleration","initialAcceleration","velocity","initialVelocity","initialPosition","lifeExpectancy","thrust","fuelAutonomy","motorThrust","exp","friction","frictionCoefficient","_context","autoShow","numberOfRockets","delayBetweenRockets","scale","WIDTH","HEIGHT","canvas","document","createElement","height","width","getContext","setTransform","promiseToWaitFor","animationFrameID","then","addEventListener","cancelAnimationFrame","remove","style","transformOrigin","transition","transitionProperty","opacity","transform","frame","getImageData","speed","data","val","putImageData","fadeOutChemTrails","all","Array","from","_","delay","random","setTimeout","undefined","skyRocket","previousState","spiderEffect","console","error","launchRocket","cellInstances","WeakMap","onclick","event","get","target","makeMove","Cell","id","game","createHTMLElement","_classPrivateFieldLooseBase","button","className","setAttribute","set","setFoot","htmlElement","removeAttribute","dataset","symbol","setWinningFlag","classList","isEmpty","enable","disabled","disable","SUPPORT_FOR_SCROLL_INTO_VIEW","Boolean","Element","scrollIntoViewIfNeeded","Grid","_this","append","map","cell","div","has","includes","isLegal","every","Error","checkForWinner","winningCells","getTicTacToeWinner","boundingRect","getBoundingClientRect","launchFireworks","top","left","body","lonelyCells","filter","forEach","Player","Game","find","grid","indexOf","winningGrids","gridId","showDialog","startNewGame","newGame","main","querySelector","firstChild","removeChild","dialogElement","winnerSymbol","celebrateWinnerBanner","h2","createTextNode","form","method","type","showModal","frag","createDocumentFragment","navigator","serviceWorker","register","scope","bottom","right","backgroundColor","padding","borderRadius","cursor","textContent","warn"],"mappings":"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"}